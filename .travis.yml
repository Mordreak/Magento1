# Travis CI Configuration File


language:   php
#sudo:       false
#dist:       trusty

php:
#  - 5.3
#  - 5.4
#  - 5.5
  - 5.6
#  - 7.0
#  - hhvm
matrix:
  allow_failures:
#  - php: 7.0
  - php: 5.6

env:
#    - MAGENTO_VERSION=magento-mirror-1.9.3.0 MAGENTO_DB_ALLOWSAME=1 
    - MAGENTO_VERSION=magento-mirror-1.9.3.6 MAGENTO_DB_ALLOWSAME=1
#  - MAGENTO_VERSION=magento-ce-1.9.0.1
#  - MAGENTO_VERSION=magento-ce-1.8.1.0
#  - MAGENTO_VERSION=magento-ce-1.8.0.0
#  - MAGENTO_VERSION=magento-ce-1.7.0.2

install:
    # Run Composer
    - composer update --no-dev
    
    # Configure Php ...
    - phpenv config-rm xdebug.ini
    - echo 'date.timezone = "Europe/Paris"' >> ~/.phpenv/versions/$(phpenv version-name)/etc/conf.d/travis.ini

    # Install Magento & Modules
    - bash build/setup.sh
    
    # Configure Splash Module
    - bash build/configure.sh    

before_script:
    - cd /tmp/magetest
    
    # Print Installation Infos
    - phpunit --version
    - tools/n98-magerun.phar --root-dir=htdocs sys:modules:list   

#    - ./n98-magerun.phar sys:modules:list
#    - ./n98-magerun.phar config:get splashsync_splash_options/*

script:
#  - curl -sSL https://raw.githubusercontent.com/SplashSync/MageTestStand/travis-ci_reject_vcs/setup.sh | bash
#  - curl -sSL https://raw.githubusercontent.com/ffuenf/MageTestStand/master/script.sh | bash
    - cd /tmp/magetest/htdocs
    - phpunit
  
#  - phpunit -c build/phpunit.xml.dist 
        
notifications:
  email:         
    on_success: never # default: change
    on_failure: never # default: always

after_failure:
